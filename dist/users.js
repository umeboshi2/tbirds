var Backbone, CurrentUser, MainChannel, MessageChannel, User, make_current_user_model;

Backbone = require('backbone');

MainChannel = Backbone.Radio.channel('global');

MessageChannel = Backbone.Radio.channel('messages');

User = class User extends Backbone.Model {};

CurrentUser = class CurrentUser extends User {};

make_current_user_model = function(url) {
  var user;
  user = new CurrentUser;
  user.url = url;
  return user;
};

MainChannel.reply('create-current-user-object', function(url) {
  var currentuser;
  currentuser = make_current_user_model(url);
  // create current-user request
  MainChannel.reply('current-user', function() {
    return currentuser;
  });
  MainChannel.reply('update-user-config', function(config) {
    var response;
    currentuser.set('config', config);
    response = currentuser.save();
    response.done(function() {
      return currentuser;
    });
    return response.fail(function() {
      return MessageChannel.request('danger', 'failed to update user config!');
    });
  });
  return currentuser;
});

module.exports = {
  User: User,
  CurrentUser: CurrentUser
};

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlcnMuanMiLCJzb3VyY2VzIjpbInVzZXJzLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxJQUFBLFFBQUEsRUFBQSxXQUFBLEVBQUEsV0FBQSxFQUFBLGNBQUEsRUFBQSxJQUFBLEVBQUE7O0FBQUEsUUFBQSxHQUFXLE9BQUEsQ0FBUSxVQUFSOztBQUVYLFdBQUEsR0FBYyxRQUFRLENBQUMsS0FBSyxDQUFDLE9BQWYsQ0FBdUIsUUFBdkI7O0FBQ2QsY0FBQSxHQUFpQixRQUFRLENBQUMsS0FBSyxDQUFDLE9BQWYsQ0FBdUIsVUFBdkI7O0FBRVgsT0FBTixNQUFBLEtBQUEsUUFBbUIsUUFBUSxDQUFDLE1BQTVCLENBQUE7O0FBRU0sY0FBTixNQUFBLFlBQUEsUUFBMEIsS0FBMUIsQ0FBQTs7QUFFQSx1QkFBQSxHQUEwQixRQUFBLENBQUMsR0FBRCxDQUFBO0FBQ3hCLE1BQUE7RUFBQSxJQUFBLEdBQU0sSUFBSTtFQUNWLElBQUksQ0FBQyxHQUFMLEdBQVc7QUFDWCxTQUFPO0FBSGlCOztBQUsxQixXQUFXLENBQUMsS0FBWixDQUFrQiw0QkFBbEIsRUFBZ0QsUUFBQSxDQUFDLEdBQUQsQ0FBQTtBQUM5QyxNQUFBO0VBQUEsV0FBQSxHQUFjLHVCQUFBLENBQXdCLEdBQXhCLEVBQWQ7O0VBRUEsV0FBVyxDQUFDLEtBQVosQ0FBa0IsY0FBbEIsRUFBa0MsUUFBQSxDQUFBLENBQUE7V0FDaEM7RUFEZ0MsQ0FBbEM7RUFFQSxXQUFXLENBQUMsS0FBWixDQUFrQixvQkFBbEIsRUFBd0MsUUFBQSxDQUFDLE1BQUQsQ0FBQTtBQUN0QyxRQUFBO0lBQUEsV0FBVyxDQUFDLEdBQVosQ0FBZ0IsUUFBaEIsRUFBMEIsTUFBMUI7SUFDQSxRQUFBLEdBQVcsV0FBVyxDQUFDLElBQVosQ0FBQTtJQUNYLFFBQVEsQ0FBQyxJQUFULENBQWMsUUFBQSxDQUFBLENBQUE7YUFDWjtJQURZLENBQWQ7V0FFQSxRQUFRLENBQUMsSUFBVCxDQUFjLFFBQUEsQ0FBQSxDQUFBO2FBQ1osY0FBYyxDQUFDLE9BQWYsQ0FBdUIsUUFBdkIsRUFBaUMsK0JBQWpDO0lBRFksQ0FBZDtFQUxzQyxDQUF4QztTQU9BO0FBWjhDLENBQWhEOztBQWVBLE1BQU0sQ0FBQyxPQUFQLEdBQ0U7RUFBQSxJQUFBLEVBQU0sSUFBTjtFQUNBLFdBQUEsRUFBYTtBQURiIiwic291cmNlc0NvbnRlbnQiOlsiQmFja2JvbmUgPSByZXF1aXJlICdiYWNrYm9uZSdcblxuTWFpbkNoYW5uZWwgPSBCYWNrYm9uZS5SYWRpby5jaGFubmVsICdnbG9iYWwnXG5NZXNzYWdlQ2hhbm5lbCA9IEJhY2tib25lLlJhZGlvLmNoYW5uZWwgJ21lc3NhZ2VzJ1xuXG5jbGFzcyBVc2VyIGV4dGVuZHMgQmFja2JvbmUuTW9kZWxcblxuY2xhc3MgQ3VycmVudFVzZXIgZXh0ZW5kcyBVc2VyXG5cbm1ha2VfY3VycmVudF91c2VyX21vZGVsID0gKHVybCkgLT5cbiAgdXNlcj0gbmV3IEN1cnJlbnRVc2VyXG4gIHVzZXIudXJsID0gdXJsXG4gIHJldHVybiB1c2VyXG4gIFxuTWFpbkNoYW5uZWwucmVwbHkgJ2NyZWF0ZS1jdXJyZW50LXVzZXItb2JqZWN0JywgKHVybCkgLT5cbiAgY3VycmVudHVzZXIgPSBtYWtlX2N1cnJlbnRfdXNlcl9tb2RlbCB1cmxcbiAgIyBjcmVhdGUgY3VycmVudC11c2VyIHJlcXVlc3RcbiAgTWFpbkNoYW5uZWwucmVwbHkgJ2N1cnJlbnQtdXNlcicsIC0+XG4gICAgY3VycmVudHVzZXJcbiAgTWFpbkNoYW5uZWwucmVwbHkgJ3VwZGF0ZS11c2VyLWNvbmZpZycsIChjb25maWcpIC0+XG4gICAgY3VycmVudHVzZXIuc2V0ICdjb25maWcnLCBjb25maWdcbiAgICByZXNwb25zZSA9IGN1cnJlbnR1c2VyLnNhdmUoKVxuICAgIHJlc3BvbnNlLmRvbmUgLT5cbiAgICAgIGN1cnJlbnR1c2VyXG4gICAgcmVzcG9uc2UuZmFpbCAtPlxuICAgICAgTWVzc2FnZUNoYW5uZWwucmVxdWVzdCAnZGFuZ2VyJywgJ2ZhaWxlZCB0byB1cGRhdGUgdXNlciBjb25maWchJ1xuICBjdXJyZW50dXNlclxuICBcblxubW9kdWxlLmV4cG9ydHMgPVxuICBVc2VyOiBVc2VyXG4gIEN1cnJlbnRVc2VyOiBDdXJyZW50VXNlclxuICBcblxuIl19
