var SimpleFileInput;

import {
  View
} from 'backbone.marionette';

import tc from 'teacup';

SimpleFileInput = (function() {
  class SimpleFileInput extends View {
    templateContext() {
      return {
        parseMsg: this.getOption('parseMsg') || 'Parse file',
        headerMsg: this.getOption('headerMsg') || 'Drop file',
        inputId: this.getOption('inputId') || 'customFile'
      };
    }

    
      // https://stackoverflow.com/a/12102992
    fileInputClicked(event) {
      console.log("file_input_clicked", event);
      this.ui.fileInput.val(null);
      return this.ui.chosenBtn.hide();
    }

    fileInputChanged(event) {
      console.log("file_input_changed", event);
      return this.ui.chosenBtn.show();
    }

    handleDrop(event) {
      var dt, file;
      event.preventDefault();
      this.ui.dropzone.css('border', '0px');
      dt = event.originalEvent.dataTransfer;
      file = dt.files[0];
      this.ui.statusMsg.text(`File: ${file.name}`);
      this.droppedFile = file;
      return this.ui.parseBtn.show();
    }

    handleDragOver(event) {
      event.preventDefault();
      return event.stopPropagation();
    }

    handleDragEnter(event) {
      event.stopPropagation();
      event.preventDefault();
      return this.ui.dropzone.css('border', '2px dotted');
    }

    fileReaderOnLoad() {
      throw {
        msg: "Notimplementederror"
      };
    }

    readFile(file) {
      var reader;
      reader = new FileReader();
      reader.onload = this.fileReaderOnLoad;
      reader.fileObject = file;
      if (this.fileType === 'binary') {
        return reader.readAsBinaryString(file);
      } else {
        return reader.readAsText(file);
      }
    }

    handleChosenFile() {
      var file, filename;
      filename = this.ui.fileInput.val();
      this.ui.statusMsg.text(`Reading chosen file...(${filename})`);
      file = this.ui.fileInput[0].files[0];
      this.ui.parseBtn.hide();
      return this.readFile(file);
    }

    handleDroppedFile() {
      this.ui.statusMsg.text(`Reading dropped file... (${this.droppedFile.name})`);
      this.ui.parseBtn.hide();
      return this.readFile(this.droppedFile);
    }

  };

  SimpleFileInput.prototype.template = tc.renderable(function(model) {
    var noDisplay;
    noDisplay = {
      style: 'display:none'
    };
    return tc.div('.dropzone.card', function() {
      tc.div('.card-header', function() {
        return tc.text(model.headerMsg);
      });
      tc.div('.card-body', function() {
        return tc.div('.parse-btn.btn.btn-primary', noDisplay, function() {
          return tc.text('upload dropped file');
        });
      });
      return tc.div('.card-footer', function() {
        tc.div('.file-input-wrapper', function() {
          tc.input(`#${model.inputId}`, {
            type: 'file'
          });
          return tc.label({
            'for': model.inputId
          }, "Choose File");
        });
        return tc.span('.parse-chosen-btn.btn.btn-primary', noDisplay, function() {
          return tc.text(model.parseMsg);
        });
      });
    });
  });

  SimpleFileInput.prototype.fileType = 'binary';

  SimpleFileInput.prototype.ui = {
    fileInput: '.file-input',
    parseBtn: '.parse-btn',
    chosenBtn: '.parse-chosen-btn',
    dropzone: '.dropzone',
    statusMsg: '.card-header'
  };

  SimpleFileInput.prototype.events = {
    'dragover @ui.dropzone': 'handleDragOver',
    'dragenter @ui.dropzone': 'handleDragEnter',
    'drop @ui.dropzone': 'handleDrop',
    'click @ui.fileInput': 'fileInputClicked',
    'change @ui.fileInput': 'fileInputChanged',
    'click @ui.parseBtn': 'handleDroppedFile',
    'click @ui.chosenBtn': 'handleChosenFile'
  };

  return SimpleFileInput;

}).call(this);

export default SimpleFileInput;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlld3Mvc2ltcGxlLWZpbGUtaW5wdXQuanMiLCJzb3VyY2VzIjpbInZpZXdzL3NpbXBsZS1maWxlLWlucHV0LmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxJQUFBOztBQUFBLE9BQUE7RUFBUyxJQUFUO0NBQUEsTUFBQTs7QUFDQSxPQUFPLEVBQVAsTUFBQTs7QUFFTTtFQUFOLE1BQUEsZ0JBQUEsUUFBOEIsS0FBOUI7SUFlRSxlQUFpQixDQUFBLENBQUE7YUFDZjtRQUFBLFFBQUEsRUFBVSxJQUFDLENBQUEsU0FBRCxDQUFXLFVBQVgsQ0FBQSxJQUEwQixZQUFwQztRQUNBLFNBQUEsRUFBVyxJQUFDLENBQUEsU0FBRCxDQUFXLFdBQVgsQ0FBQSxJQUEyQixXQUR0QztRQUVBLE9BQUEsRUFBUyxJQUFDLENBQUEsU0FBRCxDQUFXLFNBQVgsQ0FBQSxJQUF5QjtNQUZsQztJQURlLENBZG5COzs7O0lBbUNFLGdCQUFrQixDQUFDLEtBQUQsQ0FBQTtNQUNoQixPQUFPLENBQUMsR0FBUixDQUFZLG9CQUFaLEVBQWtDLEtBQWxDO01BQ0EsSUFBQyxDQUFBLEVBQUUsQ0FBQyxTQUFTLENBQUMsR0FBZCxDQUFrQixJQUFsQjthQUNBLElBQUMsQ0FBQSxFQUFFLENBQUMsU0FBUyxDQUFDLElBQWQsQ0FBQTtJQUhnQjs7SUFLbEIsZ0JBQWtCLENBQUMsS0FBRCxDQUFBO01BQ2hCLE9BQU8sQ0FBQyxHQUFSLENBQVksb0JBQVosRUFBa0MsS0FBbEM7YUFDQSxJQUFDLENBQUEsRUFBRSxDQUFDLFNBQVMsQ0FBQyxJQUFkLENBQUE7SUFGZ0I7O0lBSWxCLFVBQVksQ0FBQyxLQUFELENBQUE7QUFDZCxVQUFBLEVBQUEsRUFBQTtNQUFJLEtBQUssQ0FBQyxjQUFOLENBQUE7TUFDQSxJQUFDLENBQUEsRUFBRSxDQUFDLFFBQVEsQ0FBQyxHQUFiLENBQWlCLFFBQWpCLEVBQTJCLEtBQTNCO01BQ0EsRUFBQSxHQUFLLEtBQUssQ0FBQyxhQUFhLENBQUM7TUFDekIs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QUEsQ0FBQSxDQUFBO1FBQ3JCLEVBQUUsQ0FBQyxHQUFILENBQU8scUJBQVAsRUFBOEIsUUFBQSxDQUFBLENBQUE7VUFDNUIsRUFBRSxDQUFDLEtBQUgsQ0FBUyxDQUFBLENBQUEsQ0FBQSxDQUFJLEtBQUssQ0FBQyxPQUFWLENBQUEsQ0FBVCxFQUE4QjtZQUFBLElBQUEsRUFBSztVQUFMLENBQTlCO2lCQUNBLEVBQUUsQ0FBQyxLQUFILENBQVM7WUFBQSxLQUFBLEVBQU0sS0FBSyxDQUFDO1VBQVosQ0FBVCxFQUE4QixhQUE5QjtRQUY0QixDQUE5QjtlQUdBLEVBQUUsQ0FBQyxJQUFILENBQVEsbUNBQVIsRUFBNkMsU0FBN0MsRUFBd0QsUUFBQSxDQUFBLENBQUE7aUJBQ3RELEVBQUUsQ0FBQyxJQUFILENBQVEsS0FBSyxDQUFDLFFBQWQ7UUFEc0QsQ0FBeEQ7TUFKcUIsQ0FBdkI7SUFOdUIsQ0FBekI7RUFGc0IsQ0FBZDs7NEJBa0JWLFFBQUEsR0FBVTs7NEJBQ1YsRUFBQSxHQUNFO0lBQUEsU0FBQSxFQUFXLGFBQVg7SUFDQSxRQUFBLEVBQVUsWUFEVjtJQUVBLFNBQUEsRUFBVyxtQkFGWDtJQUdBLFFBQUEsRUFBVSxXQUhWO0lBSUEsU0FBQSxFQUFXO0VBSlg7OzRCQUtGLE1BQUEsR0FDRTtJQUFBLHVCQUFBLEVBQXlCLGdCQUF6QjtJQUNBLHdCQUFBLEVBQTBCLGlCQUQxQjtJQUVBLG1CQUFBLEVBQXFCLFlBRnJCO0lBR0EscUJBQUEsRUFBdUIsa0JBSHZCO0lBSUEsc0JBQUEsRUFBd0Isa0JBSnhCO0lBS0Esb0JBQUEsRUFBc0IsbUJBTHRCO0lBTUEscUJBQUEsRUFBdUI7RUFOdkI7Ozs7OztBQThESixPQUFBLFFBQWUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWaWV3IH0gZnJvbSAnYmFja2JvbmUubWFyaW9uZXR0ZSdcbmltcG9ydCB0YyBmcm9tICd0ZWFjdXAnXG5cbmNsYXNzIFNpbXBsZUZpbGVJbnB1dCBleHRlbmRzIFZpZXdcbiAgdGVtcGxhdGU6IHRjLnJlbmRlcmFibGUgKG1vZGVsKSAtPlxuICAgIG5vRGlzcGxheSA9IHN0eWxlOidkaXNwbGF5Om5vbmUnXG4gICAgdGMuZGl2ICcuZHJvcHpvbmUuY2FyZCcsIC0+XG4gICAgICB0Yy5kaXYgJy5jYXJkLWhlYWRlcicsIC0+XG4gICAgICAgIHRjLnRleHQgbW9kZWwuaGVhZGVyTXNnXG4gICAgICB0Yy5kaXYgJy5jYXJkLWJvZHknLCAtPlxuICAgICAgICB0Yy5kaXYgJy5wYXJzZS1idG4uYnRuLmJ0bi1wcmltYXJ5Jywgbm9EaXNwbGF5LCAtPlxuICAgICAgICAgIHRjLnRleHQgJ3VwbG9hZCBkcm9wcGVkIGZpbGUnXG4gICAgICB0Yy5kaXYgJy5jYXJkLWZvb3RlcicsIC0+XG4gICAgICAgIHRjLmRpdiAnLmZpbGUtaW5wdXQtd3JhcHBlcicsIC0+XG4gICAgICAgICAgdGMuaW5wdXQgXCIjI3ttb2RlbC5pbnB1dElkfVwiLCB0eXBlOidmaWxlJ1xuICAgICAgICAgIHRjLmxhYmVsICdmb3InOm1vZGVsLmlucHV0SWQsIFwiQ2hvb3NlIEZpbGVcIlxuICAgICAgICB0Yy5zcGFuICcucGFyc2UtY2hvc2VuLWJ0bi5idG4uYnRuLXByaW1hcnknLCBub0Rpc3BsYXksIC0+XG4gICAgICAgICAgdGMudGV4dCBtb2RlbC5wYXJzZU1zZ1xuICB0ZW1wbGF0ZUNvbnRleHQ6IC0+XG4gICAgcGFyc2VNc2c6IEBnZXRPcHRpb24oJ3BhcnNlTXNnJykgb3IgJ1BhcnNlIGZpbGUnXG4gICAgaGVhZGVyTXNnOiBAZ2V0T3B0aW9uKCdoZWFkZXJNc2cnKSBvciAnRHJvcCBmaWxlJ1xuICAgIGlucHV0SWQ6IEBnZXRPcHRpb24oJ2lucHV0SWQnKSBvciAnY3VzdG9tRmlsZSdcbiAgZmlsZVR5cGU6ICdiaW5hcnknXG4gIHVpOlxuICAgIGZpbGVJbnB1dDogJy5maWxlLWlucHV0J1xuICAgIHBhcnNlQnRuOiAnLnBhcnNlLWJ0bidcbiAgICBjaG9zZW5CdG46ICcucGFyc2UtY2hvc2VuLWJ0bidcbiAgICBkcm9wem9uZTogJy5kcm9wem9uZSdcbiAgICBzdGF0dXNNc2c6ICcuY2FyZC1oZWFkZXInXG4gIGV2ZW50czpcbiAgICAnZHJhZ292ZXIgQHVpLmRyb3B6b25lJzogJ2hhbmRsZURyYWdPdmVyJ1xuICAgICdkcmFnZW50ZXIgQHVpLmRyb3B6b25lJzogJ2hhbmRsZURyYWdFbnRlcidcbiAgICAnZHJvcCBAdWkuZHJvcHpvbmUnOiAnaGFuZGxlRHJvcCdcbiAgICAnY2xpY2sgQHVpLmZpbGVJbnB1dCc6ICdmaWxlSW5wdXRDbGlja2VkJ1xuICAgICdjaGFuZ2UgQHVpLmZpbGVJbnB1dCc6ICdmaWxlSW5wdXRDaGFuZ2VkJ1xuICAgICdjbGljayBAdWkucGFyc2VCdG4nOiAnaGFuZGxlRHJvcHBlZEZpbGUnXG4gICAgJ2NsaWNrIEB1aS5jaG9zZW5CdG4nOiAnaGFuZGxlQ2hvc2VuRmlsZSdcbiAgICBcbiAgIyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTIxMDI5OTJcbiAgZmlsZUlucHV0Q2xpY2tlZDogKGV2ZW50KSAtPlxuICAgIGNvbnNvbGUubG9nIFwiZmlsZV9pbnB1dF9jbGlja2VkXCIsIGV2ZW50XG4gICAgQHVpLmZpbGVJbnB1dC52YWwgbnVsbFxuICAgIEB1aS5jaG9zZW5CdG4uaGlkZSgpXG5cbiAgZmlsZUlucHV0Q2hhbmdlZDogKGV2ZW50KSAtPlxuICAgIGNvbnNvbGUubG9nIFwiZmlsZV9pbnB1dF9jaGFuZ2VkXCIsIGV2ZW50XG4gICAgQHVpLmNob3NlbkJ0bi5zaG93KClcbiAgICBcbiAgaGFuZGxlRHJvcDogKGV2ZW50KSAtPlxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICBAdWkuZHJvcHpvbmUuY3NzICdib3JkZXInLCAnMHB4J1xuICAgIGR0ID0gZXZlbnQub3JpZ2luYWxFdmVudC5kYXRhVHJhbnNmZXJcbiAgICBmaWxlID0gZHQuZmlsZXNbMF1cbiAgICBAdWkuc3RhdHVzTXNnLnRleHQgXCJGaWxlOiAje2ZpbGUubmFtZX1cIlxuICAgIEBkcm9wcGVkRmlsZSA9IGZpbGVcbiAgICBAdWkucGFyc2VCdG4uc2hvdygpXG4gICAgXG4gIGhhbmRsZURyYWdPdmVyOiAoZXZlbnQpIC0+XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpXG4gICAgXG4gIGhhbmRsZURyYWdFbnRlcjogKGV2ZW50KSAtPlxuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgIEB1aS5kcm9wem9uZS5jc3MgJ2JvcmRlcicsICcycHggZG90dGVkJ1xuXG4gIGZpbGVSZWFkZXJPbkxvYWQ6IC0+XG4gICAgdGhyb3cge21zZzpcIk5vdGltcGxlbWVudGVkZXJyb3JcIn1cbiAgICBcbiAgICAgIFxuICByZWFkRmlsZTogKGZpbGUpIC0+XG4gICAgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKVxuICAgIHJlYWRlci5vbmxvYWQgPSBAZmlsZVJlYWRlck9uTG9hZFxuICAgIHJlYWRlci5maWxlT2JqZWN0ID0gZmlsZVxuICAgIGlmIEBmaWxlVHlwZSA9PSAnYmluYXJ5J1xuICAgICAgcmVhZGVyLnJlYWRBc0JpbmFyeVN0cmluZyBmaWxlXG4gICAgZWxzZVxuICAgICAgcmVhZGVyLnJlYWRBc1RleHQgZmlsZVxuICAgICAgXG4gICAgXG4gIGhhbmRsZUNob3NlbkZpbGU6IC0+XG4gICAgZmlsZW5hbWUgPSBAdWkuZmlsZUlucHV0LnZhbCgpXG4gICAgQHVpLnN0YXR1c01zZy50ZXh0IFwiUmVhZGluZyBjaG9zZW4gZmlsZS4uLigje2ZpbGVuYW1lfSlcIlxuICAgIGZpbGUgPSBAdWkuZmlsZUlucHV0WzBdLmZpbGVzWzBdXG4gICAgQHVpLnBhcnNlQnRuLmhpZGUoKVxuICAgIEByZWFkRmlsZSBmaWxlXG4gICAgXG4gIGhhbmRsZURyb3BwZWRGaWxlOiAtPlxuICAgIEB1aS5zdGF0dXNNc2cudGV4dCBcIlJlYWRpbmcgZHJvcHBlZCBmaWxlLi4uICgje0Bkcm9wcGVkRmlsZS5uYW1lfSlcIlxuICAgIEB1aS5wYXJzZUJ0bi5oaWRlKClcbiAgICBAcmVhZEZpbGUgQGRyb3BwZWRGaWxlXG5cbmV4cG9ydCBkZWZhdWx0IFNpbXBsZUZpbGVJbnB1dFxuIl19
