var $, Backbone, BaseLocalStorageCollection, MainChannel, Marionette, MessageChannel, ResourceChannel, _;

$ = require('jquery');

_ = require('underscore');

Backbone = require('backbone');

Marionette = require('backbone.marionette');

MainChannel = Backbone.Radio.channel('global');

MessageChannel = Backbone.Radio.channel('messages');

ResourceChannel = Backbone.Radio.channel('resources');

BaseLocalStorageCollection = (function() {
  class BaseLocalStorageCollection extends Backbone.Collection {
    initialize() {
      //console.log "initialize DocumentCollection"
      this.fetch();
      return this.on('change', this.save, this);
    }

    fetch() {
      var docs;
      //console.log 'fetching documents'
      docs = JSON.parse(localStorage.getItem(this.local_storage_key)) || [];
      return this.set(docs);
    }

    // FIXME!
    save(collection) {
      //console.log 'saving documents'
      return localStorage.setItem(this.local_storage_key, JSON.stringify(this.toJSON()));
    }

  };

  BaseLocalStorageCollection.prototype.local_storage_key = null;

  return BaseLocalStorageCollection;

}).call(this);

module.exports = {
  BaseLocalStorageCollection: BaseLocalStorageCollection
};

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibHNjb2xsZWN0aW9uLmpzIiwic291cmNlcyI6WyJsc2NvbGxlY3Rpb24uY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLElBQUEsQ0FBQSxFQUFBLFFBQUEsRUFBQSwwQkFBQSxFQUFBLFdBQUEsRUFBQSxVQUFBLEVBQUEsY0FBQSxFQUFBLGVBQUEsRUFBQTs7QUFBQSxDQUFBLEdBQUksT0FBQSxDQUFRLFFBQVI7O0FBQ0osQ0FBQSxHQUFJLE9BQUEsQ0FBUSxZQUFSOztBQUNKLFFBQUEsR0FBVyxPQUFBLENBQVEsVUFBUjs7QUFDWCxVQUFBLEdBQWEsT0FBQSxDQUFRLHFCQUFSOztBQUdiLFdBQUEsR0FBYyxRQUFRLENBQUMsS0FBSyxDQUFDLE9BQWYsQ0FBdUIsUUFBdkI7O0FBQ2QsY0FBQSxHQUFpQixRQUFRLENBQUMsS0FBSyxDQUFDLE9BQWYsQ0FBdUIsVUFBdkI7O0FBQ2pCLGVBQUEsR0FBa0IsUUFBUSxDQUFDLEtBQUssQ0FBQyxPQUFmLENBQXVCLFdBQXZCOztBQUdaO0VBQU4sTUFBQSwyQkFBQSxRQUF5QyxRQUFRLENBQUMsV0FBbEQ7SUFFRSxVQUFZLENBQUEsQ0FBQSxFQUFBOztNQUVWLElBQUMsQ0FBQSxLQUFELENBQUE7YUFDQSxJQUFDLENBQUEsRUFBRCxDQUFJLFFBQUosRUFBYyxJQUFDLENBQUEsSUFBZixFQUFxQixJQUFyQjtJQUhVOztJQUtaLEtBQU8sQ0FBQSxDQUFBO0FBRUwsVUFBQSxJQUFBOztNQUFBLElBQUEsR0FBTyxJQUFJLENBQUMsS0FBTCxDQUFXLFlBQVksQ0FBQyxPQUFiLENBQXFCLElBQUMsQ0FBQSxpQkFBdEIsQ0FBWCxDQUFBLElBQXdEO2FBQy9ELElBQUMsQ0FBQSxHQUFELENBQUssSUFBTDtJQUhLLENBTlA7OztJQVlBLElBQU0sQ0FBQyxVQUFELENBQUEsRUFBQTs7YUFFSixZQUFZLENBQUMsT0FBYixDQUFxQixJQUFDLENBQUEsaUJBQXRCLEVBQXlDLElBQUksQ0FBQyxTQUFMLENBQWUsSUFBQyxDQUFBLE1BQUQsQ0FBQSxDQUFmLENBQXpDO0lBRkk7O0VBYlI7O3VDQUNFLGlCQUFBLEdBQW1COzs7Ozs7QUFrQnJCLE1BQU0sQ0FBQyxPQUFQLEdBQ0U7RUFBQSwwQkFBQSxFQUE0QjtBQUE1QiIsInNvdXJjZXNDb250ZW50IjpbIiQgPSByZXF1aXJlICdqcXVlcnknXG5fID0gcmVxdWlyZSAndW5kZXJzY29yZSdcbkJhY2tib25lID0gcmVxdWlyZSAnYmFja2JvbmUnXG5NYXJpb25ldHRlID0gcmVxdWlyZSAnYmFja2JvbmUubWFyaW9uZXR0ZSdcblxuXG5NYWluQ2hhbm5lbCA9IEJhY2tib25lLlJhZGlvLmNoYW5uZWwgJ2dsb2JhbCdcbk1lc3NhZ2VDaGFubmVsID0gQmFja2JvbmUuUmFkaW8uY2hhbm5lbCAnbWVzc2FnZXMnXG5SZXNvdXJjZUNoYW5uZWwgPSBCYWNrYm9uZS5SYWRpby5jaGFubmVsICdyZXNvdXJjZXMnXG5cblxuY2xhc3MgQmFzZUxvY2FsU3RvcmFnZUNvbGxlY3Rpb24gZXh0ZW5kcyBCYWNrYm9uZS5Db2xsZWN0aW9uXG4gIGxvY2FsX3N0b3JhZ2Vfa2V5OiBudWxsXG4gIGluaXRpYWxpemU6ICgpIC0+XG4gICAgI2NvbnNvbGUubG9nIFwiaW5pdGlhbGl6ZSBEb2N1bWVudENvbGxlY3Rpb25cIlxuICAgIEBmZXRjaCgpXG4gICAgQG9uICdjaGFuZ2UnLCBAc2F2ZSwgQFxuICAgIFxuICBmZXRjaDogKCkgLT5cbiAgICAjY29uc29sZS5sb2cgJ2ZldGNoaW5nIGRvY3VtZW50cydcbiAgICBkb2NzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShAbG9jYWxfc3RvcmFnZV9rZXkpKSB8fCBbXVxuICAgIEBzZXQgZG9jc1xuXG4gICMgRklYTUUhXG4gIHNhdmU6IChjb2xsZWN0aW9uKSAtPlxuICAgICNjb25zb2xlLmxvZyAnc2F2aW5nIGRvY3VtZW50cydcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShAbG9jYWxfc3RvcmFnZV9rZXksIEpTT04uc3RyaW5naWZ5KEB0b0pTT04oKSkpXG4gICAgXG4gIFxuICBcbm1vZHVsZS5leHBvcnRzID1cbiAgQmFzZUxvY2FsU3RvcmFnZUNvbGxlY3Rpb246IEJhc2VMb2NhbFN0b3JhZ2VDb2xsZWN0aW9uXG4gIFxuXG4iXX0=
