var BaseController, ExtraController, MainChannel, MainController, NavbarChannel;

import $ from 'jquery';

import Backbone from 'backbone';

import {
  MnObject
} from 'backbone.marionette';

import {
  ToolbarAppletLayout
} from './views/layout';

import navigate_to_url from './util/navigate-to-url';

import scroll_top_fast from './util/scroll-top-fast';

MainChannel = Backbone.Radio.channel('global');

NavbarChannel = Backbone.Radio.channel('navbar');

//class BaseController extends MnObject
BaseController = MnObject.extend({
  init_page: function() {},
  // do nothing
  scrollTop: scroll_top_fast,
  scroll_top: function() {
    console.warn("use scrollTop instead");
    return this.scrollTop(arguments);
  },
  navigateToUrl: navigate_to_url,
  navigate_to_url: function() {
    console.warn("use navigateToUrl instead");
    return this.navigateToUrl(arguments);
  }
});

//class MainController extends BaseController
MainController = BaseController.extend({
  layoutClass: ToolbarAppletLayout,
  _getAppletRegion: function() {
    var app;
    app = MainChannel.request('main:app:object');
    return app.getView().getRegion('applet');
  },
  setupLayout: function() {
    var layoutClass, region;
    layoutClass = this.getOption('layoutClass');
    this.layout = new layoutClass;
    region = this._getAppletRegion();
    if (region.hasView()) {
      region.empty();
    }
    this.applet.setupAppletEntries();
    region.show(this.layout);
  },
  
  // use this method to create a layout only if
  // needed, making routing within the applet
  // more efficient.
  setupLayoutIfNeeded: function() {
    var viewEntries;
    if (this.layout === void 0) {
      this.setupLayout();
    } else if (this.layout.isDestroyed()) {
      this.setupLayout();
    }
    viewEntries = NavbarChannel.request('get-entries', 'view');
    viewEntries.reset();
  },
  setup_layout_if_needed: function() {
    console.warn("use setupLayoutIfNeeded instead");
    this.setupLayoutIfNeeded();
  },
  _get_region: function(region) {
    console.warn("use _getRegion instead");
    return this._getRegion(region);
  },
  _show_view: function(vclass, model) {
    console.warn("use _showView instead");
    return this._showView(vclass, model);
  },
  _load_view: function(vclass, model, objname) {
    console.warn("use _loadView instead");
    return this._loadView(vclass, model, objname);
  },
  _getRegion: function(region) {
    return this.layout.getRegion(region);
  },
  _showView: function(vclass, model) {
    var options, view;
    options = {
      model: model
    };
    if (model instanceof Backbone.Collection) {
      options = {
        collection: model
      };
    }
    view = new vclass(options);
    this.layout.showChildView('content', view);
  },
  _isModelAbsent: function(model) {
    if (model instanceof Backbone.Collection) {
      return model.isEmpty();
    }
    // FIXME
    // presume "id" is only attribute there if length is 1
    return model.isEmpty() || Object.keys(model.attributes).length === 1;
  },
  _loadView: function(vclass, model, objname) {
    var response;
    if (this._isModelAbsent(model)) {
      response = model.fetch();
      response.done(() => {
        this._showView(vclass, model);
      });
      response.fail(function() {
        var msg;
        msg = `Failed to load ${objname} data.`;
        MessageChannel.request('danger', msg);
      });
    } else {
      this._showView(vclass, model);
    }
  }
});


//class ExtraController extends BaseController
ExtraController = BaseController.extend({
  channelName: function() {
    return this.getOption('channelName') || 'global';
  },
  initialize: function(options) {
    this.appletName = options.appletName;
    this.applet = MainChannel.request('main:applet:get-applet', this.appletName);
    this.mainController = this.applet.router.controller;
    this.channel = this.getChannel();
  },
  setup_layout_if_needed: function() {
    this.mainController.setup_layout_if_needed();
  },
  showChildView: function(region, view) {
    this.mainController.layout.showChildView(region, view);
  }
});

export {
  
  //module.exports =
  //  BaseController: BaseController
  //  MainController: MainController
  //  ExtraController: ExtraController
  BaseController,
  MainController,
  ExtraController
};

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udHJvbGxlcnMuanMiLCJzb3VyY2VzIjpbImNvbnRyb2xsZXJzLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxJQUFBLGNBQUEsRUFBQSxlQUFBLEVBQUEsV0FBQSxFQUFBLGNBQUEsRUFBQTs7QUFBQSxPQUFPLENBQVAsTUFBQTs7QUFDQSxPQUFPLFFBQVAsTUFBQTs7QUFDQSxPQUFBO0VBQVMsUUFBVDtDQUFBLE1BQUE7O0FBRUEsT0FBQTtFQUFTLG1CQUFUO0NBQUEsTUFBQTs7QUFFQSxPQUFPLGVBQVAsTUFBQTs7QUFDQSxPQUFPLGVBQVAsTUFBQTs7QUFFQSxXQUFBLEdBQWMsUUFBUSxDQUFDLEtBQUssQ0FBQyxPQUFmLENBQXVCLFFBQXZCOztBQUNkLGFBQUEsR0FBZ0IsUUFBUSxDQUFDLEtBQUssQ0FBQyxPQUFmLENBQXVCLFFBQXZCLEVBVmhCOzs7QUFhQSxjQUFBLEdBQWlCLFFBQVEsQ0FBQyxNQUFULENBQ2Y7RUFBQSxTQUFBLEVBQVcsUUFBQSxDQUFBLENBQUEsRUFBQSxDQUFYOztFQUVBLFNBQUEsRUFBVyxlQUZYO0VBR0EsVUFBQSxFQUFZLFFBQUEsQ0FBQSxDQUFBO0lBQ1YsT0FBTyxDQUFDLElBQVIsQ0FBYSx1QkFBYjtXQUNBLElBQUMsQ0FBQSxTQUFELENBQVcsU0FBWDtFQUZVLENBSFo7RUFNQSxhQUFBLEVBQWUsZUFOZjtFQU9BLGVBQUEsRUFBaUIsUUFBQSxDQUFBLENBQUE7SUFDZixPQUFPLENBQUMsSUFBUixDQUFhLDJCQUFiO1dBQ0EsSUFBQyxDQUFBLGFBQUQsQ0FBZSxTQUFmO0VBRmU7QUFQakIsQ0FEZSxFQWJqQjs7O0FBMEJBLGNBQUEsR0FBaUIsY0FBYyxDQUFDLE1BQWYsQ0FDZjtFQUFBLFdBQUEsRUFBYSxtQkFBYjtFQUVBLGdCQUFBLEVBQWtCLFFBQUEsQ0FBQSxDQUFBO0FBQ2hCLFFBQUE7SUFBQSxHQUFBLEdBQU0sV0FBVyxDQUFDLE9BQVosQ0FBb0IsaUJBQXBCO0FBQ04sV0FBTyxHQUFHLENB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QSxhQUFBLEVBQWUsUUFBQSxDQUFDLE1BQUQsRUFBUyxJQUFULENBQUE7SUFDYixJQUFDLENBQUEsY0FBYyxDQUFDLE1BQU0sQ0FBQyxhQUF2QixDQUFxQyxNQUFyQyxFQUE2QyxJQUE3QztFQURhO0FBWGYsQ0FEZ0I7O0FBcUJsQixPQUFBOzs7Ozs7RUFDRSxjQURGO0VBRUUsY0FGRjtFQUdFLGVBSEYiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgJCBmcm9tICdqcXVlcnknXG5pbXBvcnQgQmFja2JvbmUgZnJvbSAnYmFja2JvbmUnXG5pbXBvcnQgeyBNbk9iamVjdCB9IGZyb20gJ2JhY2tib25lLm1hcmlvbmV0dGUnXG5cbmltcG9ydCB7IFRvb2xiYXJBcHBsZXRMYXlvdXQgfSBmcm9tICcuL3ZpZXdzL2xheW91dCdcblxuaW1wb3J0IG5hdmlnYXRlX3RvX3VybCBmcm9tICcuL3V0aWwvbmF2aWdhdGUtdG8tdXJsJ1xuaW1wb3J0IHNjcm9sbF90b3BfZmFzdCBmcm9tICcuL3V0aWwvc2Nyb2xsLXRvcC1mYXN0J1xuXG5NYWluQ2hhbm5lbCA9IEJhY2tib25lLlJhZGlvLmNoYW5uZWwgJ2dsb2JhbCdcbk5hdmJhckNoYW5uZWwgPSBCYWNrYm9uZS5SYWRpby5jaGFubmVsICduYXZiYXInXG5cbiNjbGFzcyBCYXNlQ29udHJvbGxlciBleHRlbmRzIE1uT2JqZWN0XG5CYXNlQ29udHJvbGxlciA9IE1uT2JqZWN0LmV4dGVuZFxuICBpbml0X3BhZ2U6ICgpIC0+XG4gICAgIyBkbyBub3RoaW5nXG4gIHNjcm9sbFRvcDogc2Nyb2xsX3RvcF9mYXN0XG4gIHNjcm9sbF90b3A6IC0+XG4gICAgY29uc29sZS53YXJuIFwidXNlIHNjcm9sbFRvcCBpbnN0ZWFkXCJcbiAgICBAc2Nyb2xsVG9wIGFyZ3VtZW50c1xuICBuYXZpZ2F0ZVRvVXJsOiBuYXZpZ2F0ZV90b191cmxcbiAgbmF2aWdhdGVfdG9fdXJsOiAtPlxuICAgIGNvbnNvbGUud2FybiBcInVzZSBuYXZpZ2F0ZVRvVXJsIGluc3RlYWRcIlxuICAgIEBuYXZpZ2F0ZVRvVXJsIGFyZ3VtZW50c1xuXG4jY2xhc3MgTWFpbkNvbnRyb2xsZXIgZXh0ZW5kcyBCYXNlQ29udHJvbGxlclxuTWFpbkNvbnRyb2xsZXIgPSBCYXNlQ29udHJvbGxlci5leHRlbmRcbiAgbGF5b3V0Q2xhc3M6IFRvb2xiYXJBcHBsZXRMYXlvdXRcblxuICBfZ2V0QXBwbGV0UmVnaW9uOiAtPlxuICAgIGFwcCA9IE1haW5DaGFubmVsLnJlcXVlc3QgJ21haW46YXBwOm9iamVjdCdcbiAgICByZXR1cm4gYXBwLmdldFZpZXcoKS5nZXRSZWdpb24gJ2FwcGxldCdcbiAgICBcbiAgc2V0dXBMYXlvdXQ6IC0+XG4gICAgbGF5b3V0Q2xhc3MgPSBAZ2V0T3B0aW9uICdsYXlvdXRDbGFzcydcbiAgICBAbGF5b3V0ID0gbmV3IGxheW91dENsYXNzXG4gICAgcmVnaW9uID0gQF9nZXRBcHBsZXRSZWdpb24oKVxuICAgIGlmIHJlZ2lvbi5oYXNWaWV3KClcbiAgICAgIHJlZ2lvbi5lbXB0eSgpXG4gICAgQGFwcGxldC5zZXR1cEFwcGxldEVudHJpZXMoKVxuICAgIHJlZ2lvbi5zaG93IEBsYXlvdXRcbiAgICByZXR1cm5cbiAgICBcbiAgIyB1c2UgdGhpcyBtZXRob2QgdG8gY3JlYXRlIGEgbGF5b3V0IG9ubHkgaWZcbiAgIyBuZWVkZWQsIG1ha2luZyByb3V0aW5nIHdpdGhpbiB0aGUgYXBwbGV0XG4gICMgbW9yZSBlZmZpY2llbnQuXG4gIHNldHVwTGF5b3V0SWZOZWVkZWQ6IC0+XG4gICAgaWYgQGxheW91dCBpcyB1bmRlZmluZWRcbiAgICAgIEBzZXR1cExheW91dCgpXG4gICAgZWxzZSBpZiBAbGF5b3V0LmlzRGVzdHJveWVkKClcbiAgICAgIEBzZXR1cExheW91dCgpXG4gICAgdmlld0VudHJpZXMgPSBOYXZiYXJDaGFubmVsLnJlcXVlc3QgJ2dldC1lbnRyaWVzJywgJ3ZpZXcnXG4gICAgdmlld0VudHJpZXMucmVzZXQoKVxuICAgIHJldHVyblxuICBcbiAgc2V0dXBfbGF5b3V0X2lmX25lZWRlZDogLT5cbiAgICBjb25zb2xlLndhcm4gXCJ1c2Ugc2V0dXBMYXlvdXRJZk5lZWRlZCBpbnN0ZWFkXCJcbiAgICBAc2V0dXBMYXlvdXRJZk5lZWRlZCgpXG4gICAgcmV0dXJuXG4gICAgXG4gIF9nZXRfcmVnaW9uOiAocmVnaW9uKSAtPlxuICAgIGNvbnNvbGUud2FybiBcInVzZSBfZ2V0UmVnaW9uIGluc3RlYWRcIlxuICAgIHJldHVybiBAX2dldFJlZ2lvbihyZWdpb24pXG4gICAgXG4gIF9zaG93X3ZpZXc6ICh2Y2xhc3MsIG1vZGVsKSAtPlxuICAgIGNvbnNvbGUud2FybiBcInVzZSBfc2hvd1ZpZXcgaW5zdGVhZFwiXG4gICAgQF9zaG93Vmlldyh2Y2xhc3MsIG1vZGVsKVxuXG4gIF9sb2FkX3ZpZXc6ICh2Y2xhc3MsIG1vZGVsLCBvYmpuYW1lKSAtPlxuICAgIGNvbnNvbGUud2FybiBcInVzZSBfbG9hZFZpZXcgaW5zdGVhZFwiXG4gICAgQF9sb2FkVmlldyh2Y2xhc3MsIG1vZGVsLCBvYmpuYW1lKVxuXG4gIF9nZXRSZWdpb246IChyZWdpb24pIC0+XG4gICAgcmV0dXJuIEBsYXlvdXQuZ2V0UmVnaW9uIHJlZ2lvblxuICAgIFxuICBfc2hvd1ZpZXc6ICh2Y2xhc3MsIG1vZGVsKSAtPlxuICAgIG9wdGlvbnMgPSBtb2RlbDogbW9kZWxcbiAgICBpZiBtb2RlbCBpbnN0YW5jZW9mIEJhY2tib25lLkNvbGxlY3Rpb25cbiAgICAgIG9wdGlvbnMgPSBjb2xsZWN0aW9uOiBtb2RlbFxuICAgIHZpZXcgPSBuZXcgdmNsYXNzIG9wdGlvbnNcbiAgICBAbGF5b3V0LnNob3dDaGlsZFZpZXcgJ2NvbnRlbnQnLCB2aWV3XG4gICAgcmV0dXJuXG4gICAgXG4gIF9pc01vZGVsQWJzZW50OiAobW9kZWwpIC0+XG4gICAgaWYgbW9kZWwgaW5zdGFuY2VvZiBCYWNrYm9uZS5Db2xsZWN0aW9uXG4gICAgICByZXR1cm4gbW9kZWwuaXNFbXB0eSgpXG4gICAgIyBGSVhNRVxuICAgICMgcHJlc3VtZSBcImlkXCIgaXMgb25seSBhdHRyaWJ1dGUgdGhlcmUgaWYgbGVuZ3RoIGlzIDFcbiAgICByZXR1cm4gbW9kZWwuaXNFbXB0eSgpIG9yIE9iamVjdC5rZXlzKG1vZGVsLmF0dHJpYnV0ZXMpLmxlbmd0aCBpcyAxXG4gICAgXG4gIF9sb2FkVmlldzogKHZjbGFzcywgbW9kZWwsIG9iam5hbWUpIC0+XG4gICAgaWYgQF9pc01vZGVsQWJzZW50KG1vZGVsKVxuICAgICAgcmVzcG9uc2UgPSBtb2RlbC5mZXRjaCgpXG4gICAgICByZXNwb25zZS5kb25lID0+XG4gICAgICAgIEBfc2hvd1ZpZXcgdmNsYXNzLCBtb2RlbFxuICAgICAgICByZXR1cm5cbiAgICAgIHJlc3BvbnNlLmZhaWwgLT5cbiAgICAgICAgbXNnID0gXCJGYWlsZWQgdG8gbG9hZCAje29iam5hbWV9IGRhdGEuXCJcbiAgICAgICAgTWVzc2FnZUNoYW5uZWwucmVxdWVzdCAnZGFuZ2VyJywgbXNnXG4gICAgICAgIHJldHVyblxuICAgIGVsc2VcbiAgICAgIEBfc2hvd1ZpZXcgdmNsYXNzLCBtb2RlbFxuICAgIHJldHVyblxuICAgIFxuI2NsYXNzIEV4dHJhQ29udHJvbGxlciBleHRlbmRzIEJhc2VDb250cm9sbGVyXG5FeHRyYUNvbnRyb2xsZXIgPSBCYXNlQ29udHJvbGxlci5leHRlbmRcbiAgY2hhbm5lbE5hbWU6IC0+XG4gICAgcmV0dXJuIEBnZXRPcHRpb24oJ2NoYW5uZWxOYW1lJykgb3IgJ2dsb2JhbCdcbiAgaW5pdGlhbGl6ZTogKG9wdGlvbnMpIC0+XG4gICAgQGFwcGxldE5hbWUgPSBvcHRpb25zLmFwcGxldE5hbWVcbiAgICBAYXBwbGV0ID0gTWFpbkNoYW5uZWwucmVxdWVzdCAnbWFpbjphcHBsZXQ6Z2V0LWFwcGxldCcsIEBhcHBsZXROYW1lXG4gICAgQG1haW5Db250cm9sbGVyID0gQGFwcGxldC5yb3V0ZXIuY29udHJvbGxlclxuICAgIEBjaGFubmVsID0gQGdldENoYW5uZWwoKVxuICAgIHJldHVyblxuICBzZXR1cF9sYXlvdXRfaWZfbmVlZGVkOiAtPlxuICAgIEBtYWluQ29udHJvbGxlci5zZXR1cF9sYXlvdXRfaWZfbmVlZGVkKClcbiAgICByZXR1cm5cbiAgc2hvd0NoaWxkVmlldzogKHJlZ2lvbiwgdmlldykgLT5cbiAgICBAbWFpbkNvbnRyb2xsZXIubGF5b3V0LnNob3dDaGlsZFZpZXcgcmVnaW9uLCB2aWV3XG4gICAgcmV0dXJuXG4gICAgXG4jbW9kdWxlLmV4cG9ydHMgPVxuIyAgQmFzZUNvbnRyb2xsZXI6IEJhc2VDb250cm9sbGVyXG4jICBNYWluQ29udHJvbGxlcjogTWFpbkNvbnRyb2xsZXJcbiMgIEV4dHJhQ29udHJvbGxlcjogRXh0cmFDb250cm9sbGVyXG5cbmV4cG9ydCB7XG4gIEJhc2VDb250cm9sbGVyXG4gIE1haW5Db250cm9sbGVyXG4gIEV4dHJhQ29udHJvbGxlclxuICB9XG4gIFxuXG4iXX0=
