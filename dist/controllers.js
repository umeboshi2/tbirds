var BaseController, ExtraController, MainChannel, MainController, NavbarChannel;

import $ from 'jquery';

import Backbone from 'backbone';

import Marionette from 'backbone.marionette';

import {
  ToolbarAppletLayout
} from './views/layout';

import navigate_to_url from './util/navigate-to-url';

import scroll_top_fast from './util/scroll-top-fast';

MainChannel = Backbone.Radio.channel('global');

NavbarChannel = Backbone.Radio.channel('navbar');

//class BaseController extends Marionette.Object
BaseController = Marionette.Object.extend({
  init_page: function() {},
  // do nothing
  scrollTop: scroll_top_fast,
  scroll_top: function() {
    console.warn("use scrollTop instead");
    return this.scrollTop(arguments);
  },
  navigateToUrl: navigate_to_url,
  navigate_to_url: function() {
    console.warn("use navigateToUrl instead");
    return this.navigateToUrl(arguments);
  }
});

//class MainController extends BaseController
MainController = BaseController.extend({
  layoutClass: ToolbarAppletLayout,
  _getAppletRegion: function() {
    var app;
    app = MainChannel.request('main:app:object');
    return app.getView().getRegion('applet');
  },
  setupLayout: function() {
    var layoutClass, region;
    layoutClass = this.getOption('layoutClass');
    this.layout = new layoutClass;
    region = this._getAppletRegion();
    if (region.hasView()) {
      region.empty();
    }
    this.applet.setupAppletEntries();
    region.show(this.layout);
  },
  
  // use this method to create a layout only if
  // needed, making routing within the applet
  // more efficient.
  setupLayoutIfNeeded: function() {
    var viewEntries;
    if (this.layout === void 0) {
      this.setupLayout();
    } else if (this.layout.isDestroyed()) {
      this.setupLayout();
    }
    viewEntries = NavbarChannel.request('get-entries', 'view');
    viewEntries.reset();
  },
  setup_layout_if_needed: function() {
    console.warn("use setupLayoutIfNeeded instead");
    this.setupLayoutIfNeeded();
  },
  _get_region: function(region) {
    console.warn("use _getRegion instead");
    return this._getRegion(region);
  },
  _show_view: function(vclass, model) {
    console.warn("use _showView instead");
    return this._showView(vclass, model);
  },
  _load_view: function(vclass, model, objname) {
    console.warn("use _loadView instead");
    return this._loadView(vclass, model, objname);
  },
  _getRegion: function(region) {
    return this.layout.getRegion(region);
  },
  _showView: function(vclass, model) {
    var options, view;
    options = {
      model: model
    };
    if (model instanceof Backbone.Collection) {
      options = {
        collection: model
      };
    }
    view = new vclass(options);
    this.layout.showChildView('content', view);
  },
  _isModelAbsent: function(model) {
    if (model instanceof Backbone.Collection) {
      return model.isEmpty();
    }
    // FIXME
    // presume "id" is only attribute there if length is 1
    return model.isEmpty() || Object.keys(model.attributes).length === 1;
  },
  _loadView: function(vclass, model, objname) {
    var response;
    if (this._isModelAbsent(model)) {
      response = model.fetch();
      response.done(() => {
        this._showView(vclass, model);
      });
      response.fail(function() {
        var msg;
        msg = `Failed to load ${objname} data.`;
        MessageChannel.request('danger', msg);
      });
    } else {
      this._showView(vclass, model);
    }
  }
});


//class ExtraController extends BaseController
ExtraController = BaseController.extend({
  channelName: function() {
    return this.getOption('channelName') || 'global';
  },
  initialize: function(options) {
    this.appletName = options.appletName;
    this.applet = MainChannel.request('main:applet:get-applet', this.appletName);
    this.mainController = this.applet.router.controller;
    this.channel = this.getChannel();
  },
  setup_layout_if_needed: function() {
    this.mainController.setup_layout_if_needed();
  },
  showChildView: function(region, view) {
    this.mainController.layout.showChildView(region, view);
  }
});

export {
  
  //module.exports =
  //  BaseController: BaseController
  //  MainController: MainController
  //  ExtraController: ExtraController
  BaseController,
  MainController,
  ExtraController
};

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udHJvbGxlcnMuanMiLCJzb3VyY2VzIjpbImNvbnRyb2xsZXJzLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxJQUFBLGNBQUEsRUFBQSxlQUFBLEVBQUEsV0FBQSxFQUFBLGNBQUEsRUFBQTs7QUFBQSxPQUFPLENBQVAsTUFBQTs7QUFDQSxPQUFPLFFBQVAsTUFBQTs7QUFDQSxPQUFPLFVBQVAsTUFBQTs7QUFFQSxPQUFBO0VBQVMsbUJBQVQ7Q0FBQSxNQUFBOztBQUVBLE9BQU8sZUFBUCxNQUFBOztBQUNBLE9BQU8sZUFBUCxNQUFBOztBQUVBLFdBQUEsR0FBYyxRQUFRLENBQUMsS0FBSyxDQUFDLE9BQWYsQ0FBdUIsUUFBdkI7O0FBQ2QsYUFBQSxHQUFnQixRQUFRLENBQUMsS0FBSyxDQUFDLE9BQWYsQ0FBdUIsUUFBdkIsRUFWaEI7OztBQWFBLGNBQUEsR0FBaUIsVUFBVSxDQUFDLE1BQU0sQ0FBQyxNQUFsQixDQUNmO0VBQUEsU0FBQSxFQUFXLFFBQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBWDs7RUFFQSxTQUFBLEVBQVcsZUFGWDtFQUdBLFVBQUEsRUFBWSxRQUFBLENBQUEsQ0FBQTtJQUNWLE9BQU8sQ0FBQyxJQUFSLENBQWEsdUJBQWI7V0FDQSxJQUFDLENBQUEsU0FBRCxDQUFXLFNBQVg7RUFGVSxDQUhaO0VBTUEsYUFBQSxFQUFlLGVBTmY7RUFPQSxlQUFBLEVBQWlCLFFBQUEsQ0FBQSxDQUFBO0lBQ2YsT0FBTyxDQUFDLElBQVIsQ0FBYSwyQkFBYjtXQUNBLElBQUMsQ0FBQSxhQUFELENBQWUsU0FBZjtFQUZlO0FBUGpCLENBRGUsRUFiakI7OztBQTBCQSxjQUFBLEdBQWlCLGNBQWMsQ0FBQyxNQUFmLENBQ2Y7RUFBQSxXQUFBLEVBQWEsbUJBQWI7RUFFQSxnQkFBQSxFQUFrQixRQUFBLENBQUEsQ0FBQTtBQUNoQixRQUFBO0lBQUEsR0FBQSxHQUFNLFdBQVcsQ0FBQyxPQUFaLENBQW9CLGlCQUFwQjtBQUNOLFdBQU8sR0FBRyxD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V0EsYUFBQSxFQUFlLFFBQUEsQ0FBQyxNQUFELEVBQVMsSUFBVCxDQUFBO0lBQ2IsSUFBQyxDQUFBLGNBQWMsQ0FBQyxNQUFNLENBQUMsYUFBdkIsQ0FBcUMsTUFBckMsRUFBNkMsSUFBN0M7RUFEYTtBQVhmLENBRGdCOztBQXFCbEIsT0FBQTs7Ozs7O0VBQ0UsY0FERjtFQUVFLGNBRkY7RUFHRSxlQUhGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICQgZnJvbSAnanF1ZXJ5J1xuaW1wb3J0IEJhY2tib25lIGZyb20gJ2JhY2tib25lJ1xuaW1wb3J0IE1hcmlvbmV0dGUgZnJvbSAnYmFja2JvbmUubWFyaW9uZXR0ZSdcblxuaW1wb3J0IHsgVG9vbGJhckFwcGxldExheW91dCB9IGZyb20gJy4vdmlld3MvbGF5b3V0J1xuXG5pbXBvcnQgbmF2aWdhdGVfdG9fdXJsIGZyb20gJy4vdXRpbC9uYXZpZ2F0ZS10by11cmwnXG5pbXBvcnQgc2Nyb2xsX3RvcF9mYXN0IGZyb20gJy4vdXRpbC9zY3JvbGwtdG9wLWZhc3QnXG5cbk1haW5DaGFubmVsID0gQmFja2JvbmUuUmFkaW8uY2hhbm5lbCAnZ2xvYmFsJ1xuTmF2YmFyQ2hhbm5lbCA9IEJhY2tib25lLlJhZGlvLmNoYW5uZWwgJ25hdmJhcidcblxuI2NsYXNzIEJhc2VDb250cm9sbGVyIGV4dGVuZHMgTWFyaW9uZXR0ZS5PYmplY3RcbkJhc2VDb250cm9sbGVyID0gTWFyaW9uZXR0ZS5PYmplY3QuZXh0ZW5kXG4gIGluaXRfcGFnZTogKCkgLT5cbiAgICAjIGRvIG5vdGhpbmdcbiAgc2Nyb2xsVG9wOiBzY3JvbGxfdG9wX2Zhc3RcbiAgc2Nyb2xsX3RvcDogLT5cbiAgICBjb25zb2xlLndhcm4gXCJ1c2Ugc2Nyb2xsVG9wIGluc3RlYWRcIlxuICAgIEBzY3JvbGxUb3AgYXJndW1lbnRzXG4gIG5hdmlnYXRlVG9Vcmw6IG5hdmlnYXRlX3RvX3VybFxuICBuYXZpZ2F0ZV90b191cmw6IC0+XG4gICAgY29uc29sZS53YXJuIFwidXNlIG5hdmlnYXRlVG9VcmwgaW5zdGVhZFwiXG4gICAgQG5hdmlnYXRlVG9VcmwgYXJndW1lbnRzXG5cbiNjbGFzcyBNYWluQ29udHJvbGxlciBleHRlbmRzIEJhc2VDb250cm9sbGVyXG5NYWluQ29udHJvbGxlciA9IEJhc2VDb250cm9sbGVyLmV4dGVuZFxuICBsYXlvdXRDbGFzczogVG9vbGJhckFwcGxldExheW91dFxuXG4gIF9nZXRBcHBsZXRSZWdpb246IC0+XG4gICAgYXBwID0gTWFpbkNoYW5uZWwucmVxdWVzdCAnbWFpbjphcHA6b2JqZWN0J1xuICAgIHJldHVybiBhcHAuZ2V0VmlldygpLmdldFJlZ2lvbiAnYXBwbGV0J1xuICAgIFxuICBzZXR1cExheW91dDogLT5cbiAgICBsYXlvdXRDbGFzcyA9IEBnZXRPcHRpb24gJ2xheW91dENsYXNzJ1xuICAgIEBsYXlvdXQgPSBuZXcgbGF5b3V0Q2xhc3NcbiAgICByZWdpb24gPSBAX2dldEFwcGxldFJlZ2lvbigpXG4gICAgaWYgcmVnaW9uLmhhc1ZpZXcoKVxuICAgICAgcmVnaW9uLmVtcHR5KClcbiAgICBAYXBwbGV0LnNldHVwQXBwbGV0RW50cmllcygpXG4gICAgcmVnaW9uLnNob3cgQGxheW91dFxuICAgIHJldHVyblxuICAgIFxuICAjIHVzZSB0aGlzIG1ldGhvZCB0byBjcmVhdGUgYSBsYXlvdXQgb25seSBpZlxuICAjIG5lZWRlZCwgbWFraW5nIHJvdXRpbmcgd2l0aGluIHRoZSBhcHBsZXRcbiAgIyBtb3JlIGVmZmljaWVudC5cbiAgc2V0dXBMYXlvdXRJZk5lZWRlZDogLT5cbiAgICBpZiBAbGF5b3V0IGlzIHVuZGVmaW5lZFxuICAgICAgQHNldHVwTGF5b3V0KClcbiAgICBlbHNlIGlmIEBsYXlvdXQuaXNEZXN0cm95ZWQoKVxuICAgICAgQHNldHVwTGF5b3V0KClcbiAgICB2aWV3RW50cmllcyA9IE5hdmJhckNoYW5uZWwucmVxdWVzdCAnZ2V0LWVudHJpZXMnLCAndmlldydcbiAgICB2aWV3RW50cmllcy5yZXNldCgpXG4gICAgcmV0dXJuXG4gIFxuICBzZXR1cF9sYXlvdXRfaWZfbmVlZGVkOiAtPlxuICAgIGNvbnNvbGUud2FybiBcInVzZSBzZXR1cExheW91dElmTmVlZGVkIGluc3RlYWRcIlxuICAgIEBzZXR1cExheW91dElmTmVlZGVkKClcbiAgICByZXR1cm5cbiAgICBcbiAgX2dldF9yZWdpb246IChyZWdpb24pIC0+XG4gICAgY29uc29sZS53YXJuIFwidXNlIF9nZXRSZWdpb24gaW5zdGVhZFwiXG4gICAgcmV0dXJuIEBfZ2V0UmVnaW9uKHJlZ2lvbilcbiAgICBcbiAgX3Nob3dfdmlldzogKHZjbGFzcywgbW9kZWwpIC0+XG4gICAgY29uc29sZS53YXJuIFwidXNlIF9zaG93VmlldyBpbnN0ZWFkXCJcbiAgICBAX3Nob3dWaWV3KHZjbGFzcywgbW9kZWwpXG5cbiAgX2xvYWRfdmlldzogKHZjbGFzcywgbW9kZWwsIG9iam5hbWUpIC0+XG4gICAgY29uc29sZS53YXJuIFwidXNlIF9sb2FkVmlldyBpbnN0ZWFkXCJcbiAgICBAX2xvYWRWaWV3KHZjbGFzcywgbW9kZWwsIG9iam5hbWUpXG5cbiAgX2dldFJlZ2lvbjogKHJlZ2lvbikgLT5cbiAgICByZXR1cm4gQGxheW91dC5nZXRSZWdpb24gcmVnaW9uXG4gICAgXG4gIF9zaG93VmlldzogKHZjbGFzcywgbW9kZWwpIC0+XG4gICAgb3B0aW9ucyA9IG1vZGVsOiBtb2RlbFxuICAgIGlmIG1vZGVsIGluc3RhbmNlb2YgQmFja2JvbmUuQ29sbGVjdGlvblxuICAgICAgb3B0aW9ucyA9IGNvbGxlY3Rpb246IG1vZGVsXG4gICAgdmlldyA9IG5ldyB2Y2xhc3Mgb3B0aW9uc1xuICAgIEBsYXlvdXQuc2hvd0NoaWxkVmlldyAnY29udGVudCcsIHZpZXdcbiAgICByZXR1cm5cbiAgICBcbiAgX2lzTW9kZWxBYnNlbnQ6IChtb2RlbCkgLT5cbiAgICBpZiBtb2RlbCBpbnN0YW5jZW9mIEJhY2tib25lLkNvbGxlY3Rpb25cbiAgICAgIHJldHVybiBtb2RlbC5pc0VtcHR5KClcbiAgICAjIEZJWE1FXG4gICAgIyBwcmVzdW1lIFwiaWRcIiBpcyBvbmx5IGF0dHJpYnV0ZSB0aGVyZSBpZiBsZW5ndGggaXMgMVxuICAgIHJldHVybiBtb2RlbC5pc0VtcHR5KCkgb3IgT2JqZWN0LmtleXMobW9kZWwuYXR0cmlidXRlcykubGVuZ3RoIGlzIDFcbiAgICBcbiAgX2xvYWRWaWV3OiAodmNsYXNzLCBtb2RlbCwgb2JqbmFtZSkgLT5cbiAgICBpZiBAX2lzTW9kZWxBYnNlbnQobW9kZWwpXG4gICAgICByZXNwb25zZSA9IG1vZGVsLmZldGNoKClcbiAgICAgIHJlc3BvbnNlLmRvbmUgPT5cbiAgICAgICAgQF9zaG93VmlldyB2Y2xhc3MsIG1vZGVsXG4gICAgICAgIHJldHVyblxuICAgICAgcmVzcG9uc2UuZmFpbCAtPlxuICAgICAgICBtc2cgPSBcIkZhaWxlZCB0byBsb2FkICN7b2JqbmFtZX0gZGF0YS5cIlxuICAgICAgICBNZXNzYWdlQ2hhbm5lbC5yZXF1ZXN0ICdkYW5nZXInLCBtc2dcbiAgICAgICAgcmV0dXJuXG4gICAgZWxzZVxuICAgICAgQF9zaG93VmlldyB2Y2xhc3MsIG1vZGVsXG4gICAgcmV0dXJuXG4gICAgXG4jY2xhc3MgRXh0cmFDb250cm9sbGVyIGV4dGVuZHMgQmFzZUNvbnRyb2xsZXJcbkV4dHJhQ29udHJvbGxlciA9IEJhc2VDb250cm9sbGVyLmV4dGVuZFxuICBjaGFubmVsTmFtZTogLT5cbiAgICByZXR1cm4gQGdldE9wdGlvbignY2hhbm5lbE5hbWUnKSBvciAnZ2xvYmFsJ1xuICBpbml0aWFsaXplOiAob3B0aW9ucykgLT5cbiAgICBAYXBwbGV0TmFtZSA9IG9wdGlvbnMuYXBwbGV0TmFtZVxuICAgIEBhcHBsZXQgPSBNYWluQ2hhbm5lbC5yZXF1ZXN0ICdtYWluOmFwcGxldDpnZXQtYXBwbGV0JywgQGFwcGxldE5hbWVcbiAgICBAbWFpbkNvbnRyb2xsZXIgPSBAYXBwbGV0LnJvdXRlci5jb250cm9sbGVyXG4gICAgQGNoYW5uZWwgPSBAZ2V0Q2hhbm5lbCgpXG4gICAgcmV0dXJuXG4gIHNldHVwX2xheW91dF9pZl9uZWVkZWQ6IC0+XG4gICAgQG1haW5Db250cm9sbGVyLnNldHVwX2xheW91dF9pZl9uZWVkZWQoKVxuICAgIHJldHVyblxuICBzaG93Q2hpbGRWaWV3OiAocmVnaW9uLCB2aWV3KSAtPlxuICAgIEBtYWluQ29udHJvbGxlci5sYXlvdXQuc2hvd0NoaWxkVmlldyByZWdpb24sIHZpZXdcbiAgICByZXR1cm5cbiAgICBcbiNtb2R1bGUuZXhwb3J0cyA9XG4jICBCYXNlQ29udHJvbGxlcjogQmFzZUNvbnRyb2xsZXJcbiMgIE1haW5Db250cm9sbGVyOiBNYWluQ29udHJvbGxlclxuIyAgRXh0cmFDb250cm9sbGVyOiBFeHRyYUNvbnRyb2xsZXJcblxuZXhwb3J0IHtcbiAgQmFzZUNvbnRyb2xsZXJcbiAgTWFpbkNvbnRyb2xsZXJcbiAgRXh0cmFDb250cm9sbGVyXG4gIH1cbiAgXG5cbiJdfQ==
